name: $(BuildDefinitionName).$(DayOfYear)$(Rev:.r)

trigger:
  - none

pr:
  - none

pool:
  vmImage: "ubuntu-latest"

variables:
  - name: Environment
    value: "dev"
  - name: Location
    value: "westus"
  - name: KeyVaultAzureSubscriptionName
    value: "Symphony-KV"
  - name: KeyVaultName
    value: "kv-symphony-env"

jobs:
  - template: ./template.bicep.validate.yml
    parameters:
      Environment: $(Environment)
      Location: $(Location)
      KeyVaultAzureSubscriptionName: $(KeyVaultAzureSubscriptionName)
      KeyVaultName: $(KeyVaultName)
  - template: ./template.bicep.previewdeploy.yml
    parameters:
      Environment: $(Environment)
      Location: $(Location)
      KeyVaultAzureSubscriptionName: $(KeyVaultAzureSubscriptionName)
      KeyVaultName: $(KeyVaultName)
  - template: ./template.bicep.test.yml
    parameters:
      Environment: $(Environment)
      Location: $(Location)
      KeyVaultAzureSubscriptionName: $(KeyVaultAzureSubscriptionName)
      KeyVaultName: $(KeyVaultName)
