name: "Main Bicep"

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

  workflow_dispatch:

jobs:
  Validate:
    uses: ./.github/workflows/_workflow.main.bicep.validate.yml
    with:
      environment: "dev"
      creds: "${{ secrets.AZURE_CREDENTIALS }}"

  Preview:
    name: "Preview"
    needs: Validate
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/checkout@v3

      - name: Run script
        run: |
          echo Hello world!

  Deploy:
    name: "Deploy"
    needs: Preview
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/checkout@v3

      - name: Run script
        run: |
          echo Hello world!

  Test:
    name: "Test"
    needs: Deploy
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/checkout@v3

      - name: Run script
        run: |
          echo Hello world!

  Report:
    name: "Report"
    needs: Test
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/checkout@v3

      - name: Run script
        run: |
          echo Hello world!
